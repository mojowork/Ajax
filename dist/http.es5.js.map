{"version":3,"file":"http.es5.js","sources":["../src/helpers/uitl.ts","../src/helpers/url.ts","../src/http.ts"],"sourcesContent":["const toString = Object.prototype.toString;\n\nexport function isObject(obj: any) : boolean{\n  return toString.call(obj) === '[object Object]';\n}\n\nexport function isDate(date: any): boolean {\n  return toString.call(date) === '[object Date]';\n}","import { isObject, isDate} from './uitl';\n\nexport function buildUrl(url: string, params?: any) {\n  // 如果没有参数，直接返回url\n  if (!params) return url;\n  // 有对象参数，序列化成一个字符串\n  let serializedParams: string = Object.keys(params).reduce((partial, key) => {\n    const value = params[key];\n    switch(true){\n      case value == null:  // 空值忽略  null、undefined\n        break;\n\n      case Array.isArray(value):  // 值为数组  foo[]=bar&foo[]=baz'\n        let arrStr = value.reduce((str: string, item: any) => {\n          return `${str}&${key}[]=${item}`;\n        }, '');\n        partial = `${partial}${arrStr}`;\n        break;\n\n      case isObject(value):  // 值为对象 对象需要encode \n        let objStr = encodeURIComponent(value);\n        partial = `${partial}&${key}=${objStr}`;\n        break;\n\n      case isDate(value):  // 值为 Date 类型 Date.toISOString()操作\n        let dateStr = value.toISOString();\n        partial = `${partial}&${key}=${dateStr}`;\n        break;\n\n        default: \n        partial = `${partial}&${key}=${value}`;\n        break;\n\n    }\n\n    return partial;\n\n  }, '');\n\n  if (url.indexOf('#') !== -1) url = url.substr(0, url.indexOf('#')); // 去除哈希值\n\n  return url.indexOf('?')!== -1\n    ? `${url}${serializedParams}`\n    : `${url}?${serializedParams.substr(1)}`;\n\n}","import { HttpRequestConfig } from './types';\nimport { buildUrl } from './helpers/url';\n\nfunction http(config: HttpRequestConfig): void {\n  const {url, methed='GET', params=null, data=null} = config;\n  let buildedUrl = url;\n  if (methed === 'GET'){\n    buildedUrl = buildUrl(url, params);\n  }\n  const xhr = new XMLHttpRequest();\n  xhr.open(methed, buildedUrl, true);\n  xhr.send(data);\n}\n\nexport default http;\n"],"names":[],"mappings":"AAAA,IAAM,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC;AAE3C,SAAgB,QAAQ,CAAC,GAAQ;IAC/B,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,iBAAiB,CAAC;CACjD;AAED,SAAgB,MAAM,CAAC,IAAS;IAC9B,OAAO,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,eAAe,CAAC;CAChD;;SCNe,QAAQ,CAAC,GAAW,EAAE,MAAY;;IAEhD,IAAI,CAAC,MAAM;QAAE,OAAO,GAAG,CAAC;;IAExB,IAAI,gBAAgB,GAAW,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,UAAC,OAAO,EAAE,GAAG;QACrE,IAAM,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;QAC1B,QAAO,IAAI;YACT,KAAK,KAAK,IAAI,IAAI;gBAChB,MAAM;YAER,KAAK,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;gBACvB,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,GAAW,EAAE,IAAS;oBAC/C,OAAU,GAAG,SAAI,GAAG,WAAM,IAAM,CAAC;iBAClC,EAAE,EAAE,CAAC,CAAC;gBACP,OAAO,GAAG,KAAG,OAAO,GAAG,MAAQ,CAAC;gBAChC,MAAM;YAER,KAAK,QAAQ,CAAC,KAAK,CAAC;gBAClB,IAAI,MAAM,GAAG,kBAAkB,CAAC,KAAK,CAAC,CAAC;gBACvC,OAAO,GAAM,OAAO,SAAI,GAAG,SAAI,MAAQ,CAAC;gBACxC,MAAM;YAER,KAAK,MAAM,CAAC,KAAK,CAAC;gBAChB,IAAI,OAAO,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;gBAClC,OAAO,GAAM,OAAO,SAAI,GAAG,SAAI,OAAS,CAAC;gBACzC,MAAM;YAEN;gBACA,OAAO,GAAM,OAAO,SAAI,GAAG,SAAI,KAAO,CAAC;gBACvC,MAAM;SAET;QAED,OAAO,OAAO,CAAC;KAEhB,EAAE,EAAE,CAAC,CAAC;IAEP,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAAE,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;IAEnE,OAAO,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAI,CAAC,CAAC;UACzB,KAAG,GAAG,GAAG,gBAAkB;UACxB,GAAG,SAAI,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAG,CAAC;CAE5C;;AC1CD,SAAS,IAAI,CAAC,MAAyB;IAC9B,IAAA,gBAAG,EAAE,kBAAY,EAAZ,mCAAY,EAAE,kBAAW,EAAX,kCAAW,EAAE,gBAAS,EAAT,gCAAS,CAAW;IAC3D,IAAI,UAAU,GAAG,GAAG,CAAC;IACrB,IAAI,MAAM,KAAK,KAAK,EAAC;QACnB,UAAU,GAAG,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;KACpC;IACD,IAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;IACjC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;IACnC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;CAChB;;;;"}